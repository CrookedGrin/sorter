"use strict";var e={organizeNodesByParent:function(e){return e.reduce((e,r)=>(e[r.parent.id]=[...e[r.parent.id]||[],r],e),{})},findDistanceFromTop:function(e,r){let t=[];r.forEach(n=>{e.forEach(e=>{if(n.id===e.id){let n=r.findIndex(r=>r.id===e.id);t.push(n)}})}),t.sort((function(e,r){return e>r?1:e<r?-1:void 0}));let n=t[t.length-1];return r.length-1-n},removeDuplicates:function(e,r){return r.filter((function(r){return!e.find((function(e){return e.id==r.id}))}))},naturalCompare:function(e,r){var t=[],n=[];for(r.name.replace(/(\d+)|(\D+)/g,(function(e,r,n){t.push([r||1/0,n||""])})),e.name.replace(/(\d+)|(\D+)/g,(function(e,r,t){n.push([r||1/0,t||""])}));t.length&&n.length;){var i=t.shift(),a=n.shift(),o=i[0]-a[0]||i[1].localeCompare(a[1]);if(o)return o}return t.length-n.length},splitFixed:function(e){let r=[],t=e[0].parent.numberOfFixedChildren,n=e.slice(e.length-t),i=e.slice(0,e.length-t);return r.push(n,i),r}};var r={alphabetical:function(r,t){switch(r.sort(e.naturalCompare),t){case"asc":return r;case"dsc":return r=r.reverse()}},position:function(e){return e.sort((function(e,r){return e.y<r.y?1:e.y>r.y?-1:e.x<r.x?1:e.x>r.x?-1:void 0})),e},random:function(e){for(let r=e.length-1;r>0;r--){const t=Math.floor(Math.random()*(r+1));[e[r],e[t]]=[e[t],e[r]]}return e},reverse:function(e){let r=e[0].parent.children;return r=r.filter((function(r){return e.some((function(e){return r.id===e.id}))})),r.reverse(),r},reverseChildren:function(e){return e=e.reverse()}},t=0;if("sorter"===figma.command){var n=figma.root.getPluginData("sortChildrenOnly");figma.showUI(__html__,{width:200,height:214}),n&&figma.ui.postMessage({sortChildrenOnly:n})}else"position"===figma.command?i("sortPosition",!1):"positionChildren"===figma.command?i("sortPosition",!0):"alphaAsc"===figma.command?i("sortAlphaAsc",!1):"alphaAscChildren"===figma.command?i("sortAlphaAsc",!0):"alphaDsc"===figma.command?i("sortAlphaDsc",!1):"alphaDscChildren"===figma.command?i("sortAlphaDsc",!0):"reverse"===figma.command?i("sortReverse",!1):"reverseChildren"===figma.command?i("sortReverse",!0):"random"===figma.command?i("sortRandom",!1):"randomChildren"===figma.command&&i("sortRandom",!0),figma.closePlugin(t+" layers sorted.");function i(n,i){let a=Array.from(figma.currentPage.selection);if(!0===i)a.forEach(i=>{let a=i,o=a.children;if(null!=o){let i=[],s=a.numberOfFixedChildren,l=!1,c=[],d=[],h=[];if(o=Array.from(o),o.length<=1)return void figma.notify("Parent must contain at least 2 children");if(s>0&&(l=!0,c=e.splitFixed(o)),"sortPosition"==n?l?(d=r.position(c[0]),h=r.position(c[1])):i=r.position(o):"sortAlphaAsc"==n?l?(d=r.alphabetical(c[0],"asc"),h=r.alphabetical(c[1],"asc")):i=r.alphabetical(o,"asc"):"sortAlphaDsc"==n?l?(d=r.alphabetical(c[0],"dsc"),h=r.alphabetical(c[1],"dsc")):i=r.alphabetical(o,"dsc"):"sortReverse"==n?l?(d=r.reverseChildren(c[0]),h=r.reverseChildren(c[1])):i=r.reverseChildren(o):l?(d=r.random(c[0]),h=r.random(c[1])):i=r.random(o),l){let e=o.length,r=a.numberOfFixedChildren;for(let n=0;n<e-r;n++)a.insertChild(n,h[n]),t++;for(let e=0;e<d.length;e++)a.appendChild(d[e]),t++}else i.forEach(e=>{a.appendChild(e),t++})}});else{if(a.length<=1)return void figma.notify("Please select at least 2 layers");let i=e.organizeNodesByParent(a);Object.entries(i).forEach(i=>{i.forEach(i=>{if(Array.isArray(i)){let a=[],o=i[0].parent,s=o.children,l=e.findDistanceFromTop(i,s),c=e.removeDuplicates(i,s);a="sortPosition"==n?r.position(i):"sortAlphaAsc"==n?r.alphabetical(i,"asc"):"sortAlphaDsc"==n?r.alphabetical(i,"dsc"):"sortReverse"==n?r.reverse(i):r.random(i);let d=[],h=c.length-l,f=c.splice(h);c.forEach(e=>{d.push(e)}),a.forEach(e=>{d.push(e)}),f.forEach(e=>{d.push(e)}),d.forEach(e=>{o.appendChild(e),t++})}})})}}figma.ui.onmessage=e=>{let r=e.order,n=e.children;figma.root.setPluginData("sortChildrenOnly",n.toString()),i(r,n),figma.notify(t+" layers sorted.",{timeout:800}),t=0};
